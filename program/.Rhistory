dir.create("output/figure/main", recursive = T)
dir.create("output/figure/region", recursive = T)
dir.create("output/module")
dir.create("../output/figure/main", recursive = T)
dir.create("../output/figure/region", recursive = T)
dir.create("../module")
dir.exists("../module")
if (dir.exists("../module") == "TRUE") {
print("i eq. j !")
}
if (dir.exists("../output/figure/main") == "FALSE") {dir.create("../output/figure/main", recursive = T)}
if (dir.exists("../output/figure/other") == "FALSE") {dir.create("../output/figure/other", recursive = T)}
if (dir.exists("../module") == "FALSE") {dir.create("../module")}
filt_VEMF    <-"^Prm_Ene|^Fin_Ene|^Pol_Cos|^Prc|^Emi_CO2|^Car_Seq|^GDP|^CNS"
filt_YEMF    <-"2005|2010|2015|2020|2025|2030|2035|2040|2045|2050"
filt_REMF    <-"USA|XE25|XER|TUR|XOC|CHN|IND|JPN|XSE|XSA|CAN|BRA|XLM|CIS|XME|XNF|XAF|World"
df_iamc<-rgdx.param(paste(path_IAMC,"global_17_IAMC.gdx",sep="/"), "IAMC_Template")%>%
filter(str_detect(VEMF, c(filt_VEMF)),str_detect(YEMF, c(filt_YEMF)),str_detect(REMF, c(filt_REMF)))
library(tidyverse)
library(gdxrrw)
df_iamc<-rgdx.param(paste(path_IAMC,"global_17_IAMC.gdx",sep="/"), "IAMC_Template")%>%
filter(str_detect(VEMF, c(filt_VEMF)),str_detect(YEMF, c(filt_YEMF)),str_detect(REMF, c(filt_REMF)))
path_IAMC    <-"../../output/iiasa_database/gdx/"
path_cbnal   <-"../../output/global/global_17/cbnal/"
path_cbnal0  <-"../../output/global/global_17/cbnal0/"
path_define  <-"../define"
path_fig     <-"../output/figure/main"
filt_VEMF    <-"^Prm_Ene|^Fin_Ene|^Pol_Cos|^Prc|^Emi_CO2|^Car_Seq|^GDP|^CNS"
filt_YEMF    <-"2005|2010|2015|2020|2025|2030|2035|2040|2045|2050"
filt_REMF    <-"USA|XE25|XER|TUR|XOC|CHN|IND|JPN|XSE|XSA|CAN|BRA|XLM|CIS|XME|XNF|XAF|World"
df_iamc<-rgdx.param(paste(path_IAMC,"global_17_IAMC.gdx",sep="/"), "IAMC_Template")%>%
filter(str_detect(VEMF, c(filt_VEMF)),str_detect(YEMF, c(filt_YEMF)),str_detect(REMF, c(filt_REMF)))
df_path      <-read_csv("..define/path.csv")
df_path      <-read_csv("../define/path.csv")
View(df_path)
df_path[df_path$name=="IAMC",]
df_path[df_path$name=="IAMC",]$path
df_path[.$name=="IAMC",]$path
df_iamc<-rgdx.param(paste(df_path[df_path$name=="IAMC",]$path,"global_17_IAMC.gdx",sep="/"), "IAMC_Template")%>%
filter(str_detect(VEMF, c(filt_VEMF)),str_detect(YEMF, c(filt_YEMF)),str_detect(REMF, c(filt_REMF)))
df_filter    <-read_csv("../define/filter2.csv")
library(tidyverse)
library(gdxrrw)
df_path      <-read_csv("../define/path.csv")
df_filter    <-read_csv("../define/filter2.csv")
df_filter$VEMF
df_iamc<-rgdx.param(paste(df_path[df_path$name=="IAMC",]$path,"global_17_IAMC.gdx",sep="/"), "IAMC_Template")%>%
filter(str_detect(VEMF, df_filter$VEMF),str_detect(YEMF, c(filt_YEMF)),str_detect(REMF, c(filt_REMF)))
View(df_iamc)
df_iamc<-rgdx.param(paste(df_path[df_path$name=="IAMC",]$path,"global_17_IAMC.gdx",sep="/"), "IAMC_Template")%>%
filter(str_detect(VEMF, c("^Prm_Ene","^Fin_Ene")))
df_iamc<-rgdx.param(paste(df_path[df_path$name=="IAMC",]$path,"global_17_IAMC.gdx",sep="/"), "IAMC_Template")%>%
filter(str_detect(VEMF, c("^Prm_Ene|^Fin_Ene")))
length(df_filter$VEMF)
paste(c("bb","a"),sep="_")
paste(c("bb","a"),c("bb","a"),sep="_")
paste(c("bb","a"),c("bb","a"),collapse="|")
paste(c("bb","a"),collapse="|")
paste(df_filter$VEMF,collapse="|")
df_iamc<-rgdx.param(paste(df_path[df_path$name=="IAMC",]$path,"global_17_IAMC.gdx",sep="/"), "IAMC_Template")%>%
filter(str_detect(VEMF, paste(df_filter$VEMF,collapse="|")))
df_iamc<-rgdx.param(paste(df_path[df_path$name=="IAMC",]$path,"global_17_IAMC.gdx",sep="/"), "IAMC_Template")%>%
filter(str_detect(VEMF, paste(df_filter$VEMF,collapse="|")),
str_detect(YEMF, paste(df_filter$YEMF,collapse="|")),
str_detect(REMF, paste(df_filter$REMF,collapse="|")))
df_filter    <-read_csv("../define/filter.csv")
paste(df_filter$YEMF,collapse="|")
df_path      <-read_csv("../define/path.csv")
df_filter    <-read_csv("../define/filter.csv")
#Data import--------------------------------------------------------------------
df_iamc<-rgdx.param(paste(df_path[df_path$name=="IAMC",]$path,"global_17_IAMC.gdx",sep="/"), "IAMC_Template")%>%
filter(str_detect(VEMF, paste(df_filter$VEMF,collapse="|")),
str_detect(YEMF, paste(df_filter$YEMF,collapse="|")),
str_detect(REMF, paste(df_filter$REMF,collapse="|")))
df_iamc<-rgdx.param(paste(df_path[df_path$name=="IAMC",]$path,"global_17_IAMC.gdx",sep="/"), "IAMC_Template")%>%
filter(str_detect(VEMF, paste(df_filter$VEMF,collapse="|")),
str_detect(YEMF, paste(df_filter$YEMF,collapse="|")),
str_detect(REMF, paste(df_filter$REMF,collapse="|")))%>%
mutate(year=as.numeric(as.character(df_iamc$YEMF)))
library(tidyverse)
library(gdxrrw)
my_theme<-theme(
panel.background = element_rect(fill = "transparent", colour = "black"),
panel.grid = element_blank(),
strip.background = element_blank(),
legend.key = element_blank()
)
p <- df_iamc%>%
filter(VEMF=="Pol_Cos_GDP_Los_rat"|VEMF=="Pol_Cos_Cns_Los_rat",REMF=="World",YEMF!="2010",YEMF!="2015")%>%
ggplot(aes(x=year , y = IAMC_Template, linetype = SCENARIO,group = SCENARIO))
p <- p + facet_wrap(. ~ VEMF, scales="free", nrow=1)
p <- p + geom_line(size=1.5)
p <- p + labs(x="", y="Economic loss (%)",linetype="Scenarios")
p <- p + geom_hline(yintercept=0,color = "grey")
p <- p + my_theme
#p <- p + scale_x_discrete(label=lb_x_r)
p <- p + theme(legend.key.size = unit(1.5, 'cm'),legend.position ="right",strip.text.y = element_text(size = 40), strip.text.x = element_text(size = 40),axis.title = element_text(size = 40),legend.title= element_text(size = 40),legend.text= element_text(size = 40),axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5,size = 35),axis.text.y = element_text(size = 36))
png(paste(df_path[df_path$name=="figure",]$path,"GDP_HH_loss.png",sep="/"), width = 5200, height = 2600,res = 300)
print(p)
dev.off()
p <- df_iamc%>%
filter(VEMF=="Pol_Cos_GDP_Los_rat"|VEMF=="Pol_Cos_Cns_Los_rat",REMF=="World",YEMF!="2010",YEMF!="2015")%>%
ggplot(aes(x=year , y = IAMC_Template, linetype = SCENARIO,group = SCENARIO))
p <- p + facet_wrap(. ~ VEMF, scales="free", nrow=1)
p <- p + geom_line(size=1.5)
p <- p + labs(x="", y="Economic loss (%)",linetype="Scenarios")
p <- p + geom_hline(yintercept=0,color = "grey")
p <- p + my_theme
#p <- p + scale_x_discrete(label=lb_x_r)
p <- p + theme(legend.key.size = unit(1, 'cm'),
legend.position ="right",
strip.text.y = element_text(size = 20),
strip.text.x = element_text(size = 20),
axis.title = element_text(size = 20),
legend.title= element_text(size = 20),
legend.text= element_text(size = 20),
axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5,size = 20),
axis.text.y = element_text(size = 20))
png(paste(df_path[df_path$name=="figure",]$path,"GDP_HH_loss.png",sep="/"), width = 5200, height = 2600,res = 300)
print(p)
dev.off()
p <- df_iamc%>%
filter(VEMF=="Pol_Cos_GDP_Los_rat"|VEMF=="Pol_Cos_Cns_Los_rat",REMF=="World",YEMF!="2010",YEMF!="2015")%>%
ggplot(aes(x=year , y = IAMC_Template, linetype = SCENARIO,group = SCENARIO))
p <- p + facet_wrap(. ~ VEMF, scales="free", nrow=1)
p <- p + geom_line(size=1.2)
p <- p + labs(x="", y="Economic loss (%)",linetype="Scenarios")
p <- p + geom_hline(yintercept=0,color = "grey")
p <- p + my_theme
#p <- p + scale_x_discrete(label=lb_x_r)
p <- p + theme(legend.key.size = unit(1, 'cm'),
legend.position ="right",
strip.text.y = element_text(size = 20),
strip.text.x = element_text(size = 20),
axis.title = element_text(size = 20),
legend.title= element_text(size = 20),
legend.text= element_text(size = 20),
axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5,size = 20),
axis.text.y = element_text(size = 20))
png(paste(df_path[df_path$name=="figure",]$path,"GDP_HH_loss.png",sep="/"), width = 5200, height = 3900,res = 300)
print(p)
dev.off()
p <- df_iamc%>%
filter(VEMF=="Pol_Cos_GDP_Los_rat"|VEMF=="Pol_Cos_Cns_Los_rat",REMF=="World",YEMF!="2010",YEMF!="2015")%>%
ggplot(aes(x=year , y = IAMC_Template, linetype = SCENARIO,group = SCENARIO))
p <- p + facet_wrap(. ~ VEMF, scales="free", nrow=1)
p <- p + geom_line(size=1.2)
p <- p + labs(x="Year", y="Economic loss (%)",linetype="Scenarios")
p <- p + geom_hline(yintercept=0,color = "grey")
p <- p + my_theme
#p <- p + scale_x_discrete(label=lb_x_r)
p <- p + theme(legend.key.size = unit(1, 'cm'),
legend.position ="right",
strip.text.y = element_text(size = 20),
strip.text.x = element_text(size = 20),
axis.title = element_text(size = 20),
legend.title= element_text(size = 20),
legend.text= element_text(size = 20),
axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5,size = 20),
axis.text.y = element_text(size = 20))
png(paste(df_path[df_path$name=="figure",]$path,"GDP_HH_loss.png",sep="/"), width = 5200, height = 3900,res = 300)
print(p)
dev.off()
p <- df_iamc%>%
filter(VEMF=="Pol_Cos_GDP_Los_rat"|VEMF=="Pol_Cos_Cns_Los_rat",REMF=="World",YEMF!="2010",YEMF!="2015")%>%
ggplot(aes(x=year , y = IAMC_Template, linetype = SCENARIO,group = SCENARIO))
p <- p + facet_wrap(. ~ VEMF, scales="free", nrow=1)
p <- p + geom_line(size=1.2)
p <- p + labs(x="Year", y="Economic loss (%)",linetype="Scenarios")
p <- p + geom_hline(yintercept=0,color = "grey")
p <- p + my_theme
#p <- p + scale_x_discrete(label=lb_x_r)
p <- p + theme(legend.key.size = unit(1, 'cm'),
legend.position ="right",
strip.text.y = element_text(size = 20),
strip.text.x = element_text(size = 20),
axis.title = element_text(size = 20),
legend.title= element_text(size = 20),
legend.text= element_text(size = 20),
axis.text.x = element_text(angle = 0, hjust = 0.5, vjust = 0.5,size = 20),
axis.text.y = element_text(size = 20))
png(paste(df_path[df_path$name=="figure",]$path,"GDP_HH_loss.png",sep="/"), width = 5000, height = 3000,res = 300)
print(p)
dev.off()
df_pri     <- read_csv("../define/primary_energy.csv")
p <- df_iamc%>%
filter(REMF=="World",YEMF!="2005",YEMF!="2010",YEMF!="2015")%>%
filter(VEMF==str_detect(VEMF, paste(df_pri$VEMF,collapse="|")))%>%
mutate(VEMF = factor(VEMF, levels=df_pri$VEMF))%>%
ggplot(aes(x=YEMF , y=IAMC_Template ))
p <- p  + facet_grid( ~ SCENARIO ,scales="fix",labeller = lb_sc)
p <- df_iamc%>%
filter(REMF=="World",YEMF!="2005",YEMF!="2010",YEMF!="2015")%>%
filter(VEMF==str_detect(VEMF, paste(df_pri$VEMF,collapse="|")))%>%
mutate(VEMF = factor(VEMF, levels=df_pri$VEMF))%>%
ggplot(aes(x=YEMF , y=IAMC_Template ))
p <- p  + facet_grid( ~ SCENARIO ,scales="fix")
p <- p　+ geom_hline(yintercept=0,color = "grey")
p <- p  + geom_bar(stat="identity",aes(fill=VEMF))
#p <- p  + scale_fill_manual(labels = lb_pri,values = fl_pri)
p <- p　+ my_theme
p <- p　+ theme(strip.text.y = element_text(size = 28),
strip.text.x = element_text(size = 28),
axis.title = element_text(size = 25),
legend.title= element_text(size = 27),
legend.text= element_text(size = 27),
axis.text.x = element_text(angle = 90, hjust = 1,vjust = 0.5,size = 22),
axis.text.y = element_text(size = 22),
axis.title.x = element_blank())
p <- p + labs(x="Year", y="Primary energy (EJ/year)", fill = "Source")
png(paste(df_path[df_path$name=="figure",]$path,"primary_energy.png",sep="/"), width = 5000, height = 3000,res = 300)
print(p)
p <-
df_iamc%>%
filter(REMF=="World",YEMF!="2005",YEMF!="2010",YEMF!="2015")%>%
filter(VEMF==str_detect(VEMF, paste(df_pri$VEMF,collapse="|")))%>%
mutate(VEMF = factor(VEMF, levels=df_pri$VEMF))%>%
View()
paste(df_pri$VEMF,collapse="|")
p <-
df_iamc%>%
filter(REMF=="World",YEMF!="2005",YEMF!="2010",YEMF!="2015")%>%
View()
p <-
df_iamc%>%
filter(REMF=="World",YEMF!="2005",YEMF!="2010",YEMF!="2015")%>%
filter(str_detect(VEMF, paste(df_pri$VEMF,collapse="|")))%>%
mutate(VEMF = factor(VEMF, levels=df_pri$VEMF))%>%
View()
p <- df_iamc%>%
filter(REMF=="World",YEMF!="2005",YEMF!="2010",YEMF!="2015")%>%
filter(str_detect(VEMF, paste(df_pri$VEMF,collapse="|")))%>%
mutate(VEMF = factor(VEMF, levels=df_pri$VEMF))%>%
ggplot(aes(x=YEMF , y=IAMC_Template ))
p <- p  + facet_grid( ~ SCENARIO ,scales="fix")
p <- p　+ geom_hline(yintercept=0,color = "grey")
p <- p  + geom_bar(stat="identity",aes(fill=VEMF))
#p <- p  + scale_fill_manual(labels = lb_pri,values = fl_pri)
p <- p　+ my_theme
p <- p　+ theme(strip.text.y = element_text(size = 28),
strip.text.x = element_text(size = 28),
axis.title = element_text(size = 25),
legend.title= element_text(size = 27),
legend.text= element_text(size = 27),
axis.text.x = element_text(angle = 90, hjust = 1,vjust = 0.5,size = 22),
axis.text.y = element_text(size = 22),
axis.title.x = element_blank())
p <- p + labs(x="Year", y="Primary energy (EJ/year)", fill = "Source")
png(paste(df_path[df_path$name=="figure",]$path,"primary_energy.png",sep="/"), width = 5000, height = 3000,res = 300)
print(p)
dev.off()
df_pri     <- read_csv("../define/primary_energy.csv")
paste(df_pri$VEMF,df_pri$source,sep="=")
c(df_pri$VEMF = df_pri$source)
p <- p  + scale_fill_manual(values = names(df_pri$source) <- df_pri$VEMF)
filter(REMF=="World",YEMF!="2005",YEMF!="2010",YEMF!="2015")%>%
filter(str_detect(VEMF, paste(df_pri$VEMF,collapse="|")))%>%
mutate(VEMF = factor(VEMF, levels=df_pri$VEMF))%>%
ggplot(aes(x=YEMF , y=IAMC_Template ))
p <- df_iamc%>%
filter(REMF=="World",YEMF!="2005",YEMF!="2010",YEMF!="2015")%>%
filter(str_detect(VEMF, paste(df_pri$VEMF,collapse="|")))%>%
mutate(VEMF = factor(VEMF, levels=df_pri$VEMF))%>%
ggplot(aes(x=YEMF , y=IAMC_Template ))
p <- p  + facet_grid( ~ SCENARIO ,scales="fix")
p <- p　+ geom_hline(yintercept=0,color = "grey")
p <- p  + geom_bar(stat="identity",aes(fill=VEMF))
p <- p  + scale_fill_manual(values = names(df_pri$source) <- df_pri$VEMF)
p <- p　+ my_theme
p <- p　+ theme(strip.text.y = element_text(size = 25),
strip.text.x = element_text(size = 25),
axis.title = element_text(size = 25),
legend.title= element_text(size = 20),
legend.text= element_text(size = 20),
axis.text.x = element_text(angle = 90, hjust = 1,vjust = 0.5,size = 22),
axis.text.y = element_text(size = 22),
axis.title.x = element_blank())
p <- p + labs(x="Year", y="Primary energy (EJ/year)", fill = "Source")
png(paste(df_path[df_path$name=="figure",]$path,"primary_energy.png",sep="/"), width = 5000, height = 3000,res = 300)
print(p)
names(df_pri$source) <- df_pri$VEMF
p <- df_iamc%>%
filter(REMF=="World",YEMF!="2005",YEMF!="2010",YEMF!="2015")%>%
filter(str_detect(VEMF, paste(df_pri$VEMF,collapse="|")))%>%
mutate(VEMF = factor(VEMF, levels=df_pri$VEMF))%>%
ggplot(aes(x=YEMF , y=IAMC_Template ))
p <- p  + facet_grid( ~ SCENARIO ,scales="fix")
p <- p　+ geom_hline(yintercept=0,color = "grey")
p <- p  + geom_bar(stat="identity",aes(fill=VEMF))
p <- p  + scale_fill_manual(values = names(df_pri$color) <- df_pri$VEMF)
p <- p　+ my_theme
p <- p　+ theme(strip.text.y = element_text(size = 25),
strip.text.x = element_text(size = 25),
axis.title = element_text(size = 25),
legend.title= element_text(size = 20),
legend.text= element_text(size = 20),
axis.text.x = element_text(angle = 90, hjust = 1,vjust = 0.5,size = 22),
axis.text.y = element_text(size = 22),
axis.title.x = element_blank())
p <- p + labs(x="Year", y="Primary energy (EJ/year)", fill = "Source")
png(paste(df_path[df_path$name=="figure",]$path,"primary_energy.png",sep="/"), width = 5000, height = 3000,res = 300)
print(p)
values <- df_pri$color
values <- df_pri$color
names(values) <- df_pri$VEMF
values
values <- df_pri$color%>%
names() <- df_pri$VEMF
values <- names(df_pri$color)
values
values <- names(df_pri$color)<- df_pri$VEMF
values
df_pri2     <- read_csv("../define/primary_energy2.csv")
df_pri2[2,]
df_pri2[1,]
